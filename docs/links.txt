flow diagram: https://app.eraser.io/workspace/UEKwgkPRaL8QMgGhBDXp